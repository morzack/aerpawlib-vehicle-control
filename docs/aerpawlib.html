<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.3"/>
    <title>aerpawlib API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#getting-started-with-aerpawlib">Getting Started with aerpawlib</a></li>
  <li><a href="#advanced-aerpawlib-multi-vehicle-control">Advanced aerpawlib: Multi-vehicle control</a></li>
  <li><a href="#aerpawlib-vehicle-configuration">aerpawlib Vehicle Configuration</a></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="aerpawlib/aerpaw.html">aerpaw</a></li>
                    <li><a href="aerpawlib/external.html">external</a></li>
                    <li><a href="aerpawlib/runner.html">runner</a></li>
                    <li><a href="aerpawlib/safetyChecker.html">safetyChecker</a></li>
                    <li><a href="aerpawlib/util.html">util</a></li>
                    <li><a href="aerpawlib/vehicle.html">vehicle</a></li>
                    <li><a href="aerpawlib/zmqutil.html">zmqutil</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
aerpawlib    </h1>

                        <div class="docstring"><p><code><a href="">aerpawlib</a></code> is a set of frameworks and tools that abstract away lower level
concepts needed to write complex scripts that run on the AERPAW platform. This
lib is intended to be used by both internal developers and researchers.</p>

<p>aerpawlib has two main design goals:</p>

<ul>
<li>Users of this lib must be able to directly translate mission logic into code
without worrying about higher level programming concepts.</li>
<li>The library must remain as Pythonic as possible, both internally and with how
it exposes itself.</li>
</ul>

<h2 id="getting-started-with-aerpawlib">Getting Started with aerpawlib</h2>

<p>This guide will take you through all the steps needed to get a basic
aerpawlib driven program working from scratch. It will also explain some of
the design decisions made by aerpawlib in some depth.</p>

<h3 id="installing-aerpawlib">Installing aerpawlib</h3>

<p>Before installing aerpawlib, there are a few dependencies that you need to
grab:</p>

<ul>
<li><code>python</code> -- versions between <code>3.6</code> and <code>3.9</code> are supported</li>
<li><code>pip</code> -- should be bundled with python in most distributions</li>
</ul>

<p>To install aerpawlib:</p>

<ul>
<li>Clone this repo. Avoid changing the path if possible after installation.</li>
<li><code>cd AERPAW-Dev/AHN/E-VM/Profile_software/vehicle_control/aerpawlib</code></li>
<li>Install as a local lib -- <code>pip install --user -e .</code></li>
</ul>

<p>After following these steps, aerpawlib will now be usable in any python
script, provided that the path isn't changed.</p>

<p>To update aerpawlib, you can simply <code>git pull</code> inside the dir to sync with
the upstream repo.</p>

<h3 id="creating-a-basic-runner">Creating a basic runner</h3>

<p>aerpawlib is built so that any script made with it in mind can be run in the
same way. To do this, it sacrifices a bit of functionality and enforces that
scripts implement a <code><a href="aerpawlib/runner.html#Runner">aerpawlib.runner.Runner</a></code>.</p>

<p>There are two main runners used by aerpawlib -- the
<code><a href="aerpawlib/runner.html#BasicRunner">aerpawlib.runner.BasicRunner</a></code>, and the <code><a href="aerpawlib/runner.html#StateMachine">aerpawlib.runner.StateMachine</a></code>:</p>

<ul>
<li><code><a href="aerpawlib/runner.html#BasicRunner">aerpawlib.runner.BasicRunner</a></code> -- has a single entry point, all flow
control is handled by the user program</li>
<li><code><a href="aerpawlib/runner.html#StateMachine">aerpawlib.runner.StateMachine</a></code> -- has multiple states of various types,
flow between states is handled by aerpawlib</li>
</ul>

<p><code><a href="aerpawlib/runner.html#BasicRunner">aerpawlib.runner.BasicRunner</a></code> is appropriate for the most basic of scripts,
so we'll use that here. It can be imported directly and linked to your script's
<code><a href="aerpawlib/runner.html#Runner">aerpawlib.runner.Runner</a></code> instance by doing the following:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn"><a href="aerpawlib/runner.html">aerpawlib.runner</a></span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicRunner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn"><a href="aerpawlib/vehicle.html">aerpawlib.vehicle</a></span><span class="w"> </span><span class="kn">import</span> <span class="n">Drone</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyScript</span><span class="p">(</span><span class="n">BasicRunner</span><span class="p">):</span>
    <span class="c1"># more things...</span>
</code></pre>
</div>

<p>When using a <code><a href="aerpawlib/runner.html#BasicRunner">aerpawlib.runner.BasicRunner</a></code>, you're allowed to create a single
function that serves as an entry point for your code. This function -- decorated
by <code><a href="aerpawlib/runner.html#entrypoint">aerpawlib.runner.entrypoint</a></code> -- will be called and passed a <code>Vehicle</code> at
runtime that you can interact with.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>    <span class="c1"># more things...</span>
    <span class="nd">@entrypoint</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Drone</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I&#39;m doing things!&quot;</span><span class="p">)</span>
</code></pre>
</div>

<p>[note: don't worry about the <code>async</code> yet! that'll be talked about a bit later]</p>

<p>Now you can run your script using the aerpawlib CLI tool:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>aerpawlib<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--script<span class="w"> </span>path/to/your/script<span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># without the .py!</span>
<span class="w">    </span>--conn<span class="w"> </span>udp:127.0.0.1:14550<span class="w"> </span><span class="se">\ </span><span class="w">   </span><span class="c1"># or whatever SITL is using</span>
<span class="w">    </span>--vehicle<span class="w"> </span>drone
</code></pre>
</div>

<pre><code># output after connecting:
I'm doing things!
</code></pre>

<p>The above command assumes you have SITL installed and it's up and running. To
install SITL, check out <a href="">TODO</a>.</p>

<h3 id="interacting-with-vehicles">Interacting with vehicles</h3>

<p>As mentioned before, the function marked by <code><a href="aerpawlib/runner.html#entrypoint">aerpawlib.runner.entrypoint</a></code> in
your script will always be passed a <code><a href="aerpawlib/vehicle.html#Vehicle">aerpawlib.vehicle.Vehicle</a></code> of some kind
-- this vehicle is determined by the vehicle <em>type</em> passed to the command line
tool.</p>

<p>There are a few kinds of vehicles that you can work with, each under
<code><a href="aerpawlib/vehicle.html">aerpawlib.vehicle</a></code>. For this script, we'll be using a <code>Drone</code> since it has
more capabilities.</p>

<p>The aerpawlib CLI tool will fully initialize whatever vehicle you're using to
be ready to use, however you must explicitly make it take off at the start of
your script.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Drone</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">takeoff</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># take off to 5 meters</span>
</code></pre>
</div>

<p>Once the drone is in the air, you have full control over its position and
heading by using <code><a href="aerpawlib/vehicle.html#Vehicle.goto_coordinates">aerpawlib.vehicle.Vehicle.goto_coordinates</a></code> and
<code><a href="aerpawlib/vehicle.html#Drone.set_heading">aerpawlib.vehicle.Drone.set_heading</a></code>.</p>

<p>Additionally, <code><a href="aerpawlib/vehicle.html#Vehicle">aerpawlib.vehicle.Vehicle</a></code>s expose properties related to their
current physical state, such as their battery level and current position.</p>

<h3 id="using-coordinates">Using coordinates</h3>

<p>aerpawlib is designed to <em>only</em> have an understanding of absolute coordinates
using latitude and longitude -- this removes an entire class of bugs and
confusion related to whether or not a vehicle is moving relative to its start
position or world-scale coordinates. Imagine if you tried to send a vehicle to
<code>(0, 0)</code>, but instead of coming home, it tried to fly out into the middle of
the ocean!</p>

<p>Keeping this in mind, aerpawlib wraps all positions inside the
<code><a href="aerpawlib/util.html#Coordinate">aerpawlib.util.Coordinate</a></code> object. This is a representation of an absolute
coordinate, with the altitude being relative to where the vehicle started.</p>

<p>To transform <code><a href="aerpawlib/util.html#Coordinate">aerpawlib.util.Coordinate</a></code>s, there's also a related
<code><a href="aerpawlib/util.html#VectorNED">aerpawlib.util.VectorNED</a></code> class -- this is a 3 dimensional vector in the
<a href="https://en.wikipedia.org/wiki/Local_tangent_plane_coordinates#Local_north,_east,_down_(NED)_coordinates">NED (north, east, down)</a>
schema. aerpawlib has overridden some of Python's operators so that you can
cleanly combine coordinates with vectors.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn"><a href="aerpawlib/util.html">aerpawlib.util</a></span><span class="w"> </span><span class="kn">import</span> <span class="n">Coordinate</span><span class="p">,</span> <span class="n">VectorNED</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">(</span><span class="mf">35.771634</span><span class="p">,</span> <span class="o">-</span><span class="mf">78.674109</span><span class="p">)</span>

<span class="c1"># get a new coord 10m north and 5m west of X</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># find the bearing (heading difference) between X and Y</span>
<span class="n">x</span><span class="o">.</span><span class="n">bearing</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>    <span class="c1"># -&gt; 315 degrees</span>

<span class="c1"># get the vector between Y and X</span>
<span class="n">vec</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>     <span class="c1"># -&gt; VectorNED(-10, 5, 0)</span>
</code></pre>
</div>

<h3 id="moving-a-vehicle">Moving a vehicle</h3>

<p>So by using a vehicle's current position combined with a vector representing
how you want to translate it, you have nearly full control over a vehicle's
position.</p>

<p>As an example, let's move a drone in a square pattern:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Drone</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="c1"># go north</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># seconds</span>

    <span class="c1"># go west</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># go south</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># go east</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># don&#39;t forget to land when you&#39;re done!</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">land</span><span class="p">()</span>
</code></pre>
</div>

<h3 id="asynchronous-programming">Asynchronous programming</h3>

<p>Because the physical state of a drone and the state of a program aren't
inherently linked, aerpawlib uses asyncio internally to help with syncing
things up.</p>

<p>What this means for you, the developer of a script, is that there are two
actions that your script can take after telling a drone what to do -- it can
either wait for the drone to complete the action before resuming the flow, or
it can continue running while waiting for the drone to finish moving in the
background.</p>

<p>In Python, these two actions are specified using the <code>await</code> keyword, or the
function <code>asyncio.ensure_future</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Drone</span><span class="p">):</span>
    <span class="c1"># go north and (a)wait for the drone to arrive</span>
    <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="c1"># go south and immediately print some things out</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span>
                                                            <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;going south now...&quot;</span><span class="p">)</span>

    <span class="c1"># wait for the action to be finished</span>
    <span class="k">await</span> <span class="n">action</span>
</code></pre>
</div>

<p>In the second example above, we capture the <code>asyncio.Task</code> returned by
<code>asyncio.ensure_future</code>, which allows for us to then <code>await</code> it later on. It's
not necessary to do this unless you want to use <code>await</code> later.</p>

<p><strong>Important!</strong></p>

<p>One caveat of using asyncio is that you can't use any functions that would
normally block the execution of the program. Fortunately, asyncio provides
implementations of the common culprits, such as <code>time.sleep</code> -- you can see how
they're used in some of the above examples.</p>

<h3 id="background-tasks">Background tasks</h3>

<p>One of the benefits of asyncio is that it allows for aerpawlib to cleanly
implement tasks that run in the background. aerpawlib exposes this
functionality through the <code><a href="aerpawlib/runner.html#background">aerpawlib.runner.background()</a></code> decorator, which
causes the decorated function to be repeatedly called in the background:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MyRunner</span><span class="p">(</span><span class="n">StateMachine</span><span class="p">):</span>
    <span class="nd">@background</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">log_in_background</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vehicle pos: </span><span class="si">{</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<p>Note that background tasks are only available to runners that use the
<code><a href="aerpawlib/runner.html#StateMachine">aerpawlib.runner.StateMachine</a></code> framework.</p>

<h3 id="creating-a-state-machine">Creating a state machine</h3>

<p>The more powerful of aerpawlib's two frameworks is
<code><a href="aerpawlib/runner.html#StateMachine">aerpawlib.runner.StateMachine</a></code>: this framework lets you create a runner with
multiple "states" that can be transitioned between by the runner.</p>

<p>A state is just a function decorated by the <code><a href="aerpawlib/runner.html#state">aerpawlib.runner.state</a></code> decorator.
This decorator allows for a state to be given a name -- this name is what
aerpawlib uses to identify states when transitioning between them.</p>

<p>When the state function is done running, it should return a string that is the
next state for the runner to run. If no string is returned, aerpawlib assumes
that the script is done running.</p>

<p>The first state used in a script must be designated by setting the
<code>first</code> parameter to true when creating it.</p>

<p>Finally, there's also a <code><a href="aerpawlib/runner.html#timed_state">aerpawlib.runner.timed_state()</a></code> decorator available.
This decorator will make sure that a state is run for <em>at least</em> a set number
of seconds before transitioning to the next state, even if the state exits
early. If the function designated as a state takes longer than the allotted
time, it will continue running until a value is returned or the function
exits.</p>

<p>Here's an example of a state machine that makes use of all the things we've
talked about so far. It makes a drone continually "take measurements" spaced
10m apart until it gets a measurement that is 0, at which point it lands.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MyScript</span><span class="p">(</span><span class="n">StateMachine</span><span class="p">):</span>
    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">take_off</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;go_north&quot;</span>

    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;go_north&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">go_north</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
        <span class="c1"># go north and continually log the vehicle&#39;s position</span>
        <span class="n">moving</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="n">VectorNED</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">moving</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pos: </span><span class="si">{</span><span class="n">vehicle</span><span class="o">.</span><span class="n">position</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">moving</span>
        <span class="k">return</span> <span class="s2">&quot;take_measurement&quot;</span>

    <span class="nd">@timed_state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;take_measurement&quot;</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">take_measurement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
        <span class="c1"># take a measurement and wait for 5 seconds</span>
        <span class="n">measurement</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">measurement</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;land&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;go_north&quot;</span>

    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;land&quot;</span><span class="p">)</span>
    <span class="n">asnyc</span> <span class="k">def</span><span class="w"> </span><span class="nf">land</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">land</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="advanced-aerpawlib-multi-vehicle-control">Advanced aerpawlib: Multi-vehicle control</h2>

<p>This is a continuation of the previous guide that will go over how to structure and write advanced aerpawlib scripts that control multiple vehicles.
There is an expectation that the reader is familiar with aerpawlib, but no knowledge of the underlying stack (zmq) is needed.</p>

<p>As aerpawlib's primary objective is to make it easy to translation mission logic into code, being able to support multi-vehicle experiments was a natural extension of its capabilities.
This overarching goal was one of the driving factors behind the usage of state machines and async code.</p>

<p>Notably, aerpawlib's multi-vehicle control architecture was designed to give as much flexibility to a user as possible, however it remains opinionated to a degree.
Multi-vehicle control software is hard, there are many ways to implement it, and providing a single standard helps avoid unmaintainable logic (ultimately giving safer code :) ).</p>

<h3 id="the-multi-vehicle-backend">The Multi-Vehicle Backend</h3>

<p>aerpawlib's multi-vehicle control is built around a zmq pub/sub stack, which connects all aerpawlib scripts through a central proxy/"broker".
This broker is a built in utility in aerpawlib, and can be run through the aerpawlib module.
Each aerpawlib script must connect back to the broker and identify itself with an identifier -- these identifiers are provided by the user at runtime, but should be known in advance to make writing code possible.</p>

<p>There are two main exposed pieces of functionality within the aerpawlib multi-vehicle framework: transitioning the state of a runner, and querying some value from a runner.
In the backend, these are implemented by routing requests to handler functions declared by the zmq runner, which in turn runs through each request as it comes in in a separate async function.</p>

<h3 id="the-multi-vehicle-structure">The Multi-Vehicle Structure</h3>

<p>As previously mentioned, aerpawlib is opnionated and designed around a set of design points.
For multi-vehicle scripts, this is even more evident.
It's difficult to explain the tenets in whole (examples are below), but here are the key points to keep in mind when designing aerpawlib scripts:</p>

<ol>
<li>aerpawlib scripts run on drones connected through mavproxy should implement <em>low-level commands</em> (ex: fly north 10m, return to launch)</li>
<li>there should be one aerpawlib script not connected physically to a drone through mavproxy that implements <em>high-level experiment logic</em> (ex: send two drones to an area, tell drones to perform a grid scan)</li>
</ol>

<p>By decoupling experiment logic from drone control as much as possible, an experiment can keep its logic entirely within a singular state machine, only using the state machines on the vehicles to control the movement at a low level.</p>

<h3 id="a-basic-multi-vehicle-script">A basic multi-vehicle script</h3>

<p>With this knowledge in hand, we can now start to build a multi-vehicle experiment.
This experiment is absed off the zmq_preplanned_orbit example.
For the purposes of this demo, we want to fly two drones through a series of waypoints (determined by a .plan file), and have one drone "orbit" the other drone at each waypoint.
The drones should remain synchronized with each other throughout the experiment.</p>

<p>To make this happen, we need 3 aerpawlib scripts:</p>

<ul>
<li>ground_coordinator -- this will read from the .plan file and send drones to coordinates</li>
<li>drone_tracer -- this will implement commands for the tracer drone, sending it from point to point</li>
<li>drone_orbiter -- this will implement commands for the orbiter drone, making it follow the tracer and orbit at certain points</li>
</ul>

<p>For the sake of brevity in this documentation page, all code is contained within the <code>examples/zmq_preplanned_orbit</code> folder.
This will only pull snippets that implement specific patterns.</p>

<h3 id="pattern-1-vehicle-control">Pattern 1: Vehicle Control</h3>

<p>As mentioned previously, scripts running on a vehicle should only implement low-level mission commands.
Let's look at a vehicle state machine to see how that's done.</p>

<p><code>drone_tracer.py</code></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TracerRunner</span><span class="p">(</span><span class="n">ZmqStateMachine</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;wait_loop&quot;</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">state_wait_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;wait_loop&quot;</span>

    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;next_waypoint&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">state_next_waypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drone</span><span class="p">:</span> <span class="n">Drone</span><span class="p">):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_field</span><span class="p">(</span><span class="n">ZMQ_GROUND</span><span class="p">,</span> <span class="s2">&quot;tracer_next_waypoint&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">drone</span><span class="o">.</span><span class="n">goto_coordinates</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_runner</span><span class="p">(</span><span class="n">ZMQ_GROUND</span><span class="p">,</span> <span class="s2">&quot;callback_tracer_at_waypoint&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;wait_loop&quot;</span>

    <span class="c1"># ...</span>
</code></pre>
</div>

<p>Fundementally, there is always one resting state for the vehicle -- <code>wait_loop</code>.
This state will continually idle the state machine, not sending any commands to the underlying hardware.
Other states such as <code>next_waypoint</code> are used to control the drone itself, in this case it gets a position managed by the ground station, sends the drone to it, and then reports back the completation of the task before returning to an idle state.</p>

<p>Now, let's see what the ground control station is doing:</p>

<p><code>ground_coordinator.py</code></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GroundCoordinatorRunner</span><span class="p">(</span><span class="n">ZmqStateMachine</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;next_waypoint&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">state_next_waypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="c1"># ...</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_runner</span><span class="p">(</span><span class="n">ZMQ_TRACER</span><span class="p">,</span> <span class="s2">&quot;next_waypoint&quot;</span><span class="p">),</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_runner</span><span class="p">(</span><span class="n">ZMQ_ORBITER</span><span class="p">,</span> <span class="s2">&quot;next_waypoint&quot;</span><span class="p">),</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tracer_at_waypoint</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orbiter_at_waypoint</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="s2">&quot;await_in_transit&quot;</span>

    <span class="c1"># funcs to calculate where each drone should go</span>
    <span class="nd">@expose_field_zmq</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tracer_next_waypoint&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_tracer_next_waypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="n">waypoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_waypoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_waypoint</span><span class="p">]</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">(</span><span class="o">*</span><span class="n">waypoint</span><span class="p">[</span><span class="s2">&quot;pos&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">coords</span>

    <span class="c1"># ...</span>

    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;await_in_transit&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">state_await_in_transit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tracer_at_waypoint</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orbiter_at_waypoint</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;await_in_transit&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;orbiter_start_orbit&quot;</span>

    <span class="nd">@state</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;callback_tracer_at_waypoint&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback_tracer_at_waypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracer_at_waypoint</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="s2">&quot;await_in_transit&quot;</span>

    <span class="c1"># ...</span>
</code></pre>
</div>

<p>The entry point for this set of states is <code>next_waypoint</code>.
Let's run through the flow:</p>

<ol>
<li>First, the ground station tells both drones to activate the <code>next_waypoint</code> state, which is the command discussed before.</li>
<li>Then, the ground station sets two flags referencing command completion to false. These will be updated by the drones as they finish their commands.</li>
<li>At this point the drones have begun their commands, and the ground station is now idling. When both flags are set to true by the drones, the script will continue.</li>
<li>Some drone will now finish the command. It calls the callback (ex: <code>callback_tracer_at_waypoint</code>), setting the flag for that drone and immediately returning to the waiting loop.</li>
<li>Finally, when both drones are done/both flags are set, the script can continue to the next state</li>
</ol>

<p>Syntactically, this is an ugly implementation, however it is clean and straightforwards.
By centralizing flow, extremely complicated scripts can be developed that dodge potential spaghetti logic.</p>

<h3 id="pattern-2-querying-fields">Pattern 2: Querying fields</h3>

<p>Querying a field or value from another vehicle/script in aerpawlib is simple, you simply have to call the <code>query_field</code> function.
This function will request the field from the relevant drone, blocking until it's received.
An example is below:</p>

<p><code>drone_orbiter.py</code></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">OrbiterRunner</span><span class="p">(</span><span class="n">ZmqStateMachine</span><span class="p">):</span>
    <span class="nd">@expose_field_zmq</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;position&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_drone_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drone</span><span class="p">:</span> <span class="n">Drone</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">drone</span><span class="o">.</span><span class="n">position</span>
    <span class="c1"># ...</span>
</code></pre>
</div>

<p><code>ground_coordinator.py</code></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GroundCoordinatorRunner</span><span class="p">(</span><span class="n">ZmqStateMachine</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="nd">@expose_field_zmq</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;orbiter_next_waypoint&quot;</span><span class="p">)</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_orbiter_next_waypoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
        <span class="n">waypoint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_waypoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_waypoint</span><span class="p">]</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">Coordinate</span><span class="p">(</span><span class="o">*</span><span class="n">waypoint</span><span class="p">[</span><span class="s2">&quot;pos&quot;</span><span class="p">])</span>
        <span class="c1"># note the query_field being awaited</span>
        <span class="n">tracer_pos</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_field</span><span class="p">(</span><span class="n">ZMQ_TRACER</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">)</span>
        <span class="n">tracer_delta</span> <span class="o">=</span> <span class="n">coords</span> <span class="o">-</span> <span class="n">tracer_pos</span>
        <span class="c1"># note the query_field being awaited, again</span>
        <span class="n">orbiter_pos</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_field</span><span class="p">(</span><span class="n">ZMQ_ORBITER</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">)</span>
        <span class="n">orbiter_next_pos</span> <span class="o">=</span> <span class="n">orbiter_pos</span> <span class="o">+</span> <span class="n">tracer_delta</span>
        <span class="k">return</span> <span class="n">orbiter_next_pos</span>
    <span class="c1"># ...</span>
</code></pre>
</div>

<h2 id="aerpawlib-vehicle-configuration">aerpawlib Vehicle Configuration</h2>

<p>aerpawlib provides support for adding constraints to vehicles that are checked during runtime.
The purpose of this is to enable safer characterisation of vehicle behaviour before enabling more dangerous features.
When launching the aerpawlib runner, a custom vehicle configuration file can be provided by using the <code>--vehicle-config</code> command line argument:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>aerpawlib<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--script<span class="w"> </span>examples/squareoff_logging<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--conn<span class="w"> </span>udp:127.0.0.1:14550<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vehicle<span class="w"> </span>drone<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--vehicle-config<span class="w"> </span>vehicle_configurations/AERPAW_SAM.yaml
</code></pre>
</div>

<p>There are several example configurations available in the vehicle_configurations folder for existing AERPAW based drones.
<code>vehicle_config_exhaustive.yaml</code> serves as documentation for the various fields, with comments explaining functionality.</p>
</div>

                        <input id="mod-aerpawlib-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-aerpawlib-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">.. include:: ./documentation.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.3.1&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;John Kesler&quot;</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.runner</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.vehicle</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.util</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.external</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span></pre></div>


            </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>